var G=Object.defineProperty;var V=(n,e,t)=>e in n?G(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var f=(n,e,t)=>V(n,typeof e!="symbol"?e+"":e,t);var u;(function(n){n.Element="element",n.Fragment="fragment",n.FunctionComponent="function",n.ClassComponent="class",n.Primitive="primitive"})(u||(u={}));const Q=Symbol("Fragment"),K="http://www.w3.org/2000/svg",X=new Set(["svg","animate","animateMotion","animateTransform","circle","clipPath","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","foreignObject","g","image","line","linearGradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","stop","switch","symbol","text","textPath","tspan","use","view"]);function A(n){return X.has(n)}function J(n){return A(n)?document.createElementNS(K,n):document.createElement(n)}function F(n){return document.createTextNode(n)}function L(n){return document.createComment(n)}function Y(n,e){n.removeChild(e)}function O(n){return typeof n=="string"?n:Array.isArray(n)?n.map(e=>typeof e=="string"?e:O(e)).filter(Boolean).join(" "):typeof n=="object"&&n!==null?Object.entries(n).filter(([e,t])=>t).map(([e])=>e).join(" "):""}function M(n,e){const t=O(e);t?n.setAttribute("class",t):n.removeAttribute("class")}function W(n,e,t){t==null||t===!1?n.removeAttribute(e):t===!0?n.setAttribute(e,""):n.setAttribute(e,String(t))}function Z(n,e){n.removeAttribute(e)}function _(n,e,t){n[e]=t}function N(n,e,t){typeof t=="number"&&!tt(e)?n.style[e]=t+"px":n.style[e]=t}function tt(n){return new Set(["animationIterationCount","columnCount","fillOpacity","flexGrow","flexShrink","fontWeight","lineHeight","opacity","order","orphans","widows","zIndex","zoom"]).has(n)}function T(n,e,t){n.addEventListener(e,t)}function q(n,e,t){n.removeEventListener(e,t)}function et(n,e,t){for(const[r,i]of Object.entries(e))if(r!=="children"&&r!=="fukict:ref"){if(r==="fukict:html"){_(n,"innerHTML",i??"");continue}if(r==="ref"&&typeof i=="function"){i(n);continue}if(r.startsWith("on:")){const s=r.slice(3);T(n,s,i);continue}if(r==="style"&&typeof i=="object"&&i!==null){for(const[s,o]of Object.entries(i))N(n,s,o);continue}if(r==="value"||r==="checked"||r==="selected"){_(n,r,i);continue}if(r==="class"){M(n,i);continue}if(r in n&&!A(n.tagName.toLowerCase())){_(n,r,i);continue}W(n,r,i)}}function j(n,e,t){n&&(n[e]?Array.isArray(n[e])?n[e].push(t):n[e]=[n[e],t]:n[e]=t)}function nt(n){if(!n)return{};const e={};for(const t of n)if(!(typeof t>"u"||t===null)){if(typeof t!="object"||!("type"in t)||!t.__slot_name__){j(e,"default",t);continue}j(e,t.__slot_name__,t)}return e}function rt(n,e){if(e)for(const t of Object.values(n))Array.isArray(t)?t.forEach(r=>{typeof r=="object"&&r&&"__type__"in r&&(r.__refOwner__=e)}):typeof t=="object"&&t&&"__type__"in t&&(t.__refOwner__=e)}function $(n,e,t){const r=e;if(n.__instance__=e,n.children){const s=nt(n.children);rt(s,t),r.$slots=s}const i=n.__refOwner__||t;if(i&&n.props&&n.props["fukict:ref"]){const s=n.props["fukict:ref"];if(typeof s=="string"){const o=i;o.$refs[s]=e}}r.__wrapper__=n,t&&(n.__parentInstance__=t)}function U(n,e){n.__dom__=e}function H(n,e){n.__dom__=e}function E(n,e,t){n.__rendered__=e,n.__dom__=t}function P(n,e){n.__dom__=e}function p(n,e){if(Array.isArray(n)){const t=[];for(const r of n){const i=p(r,e);i&&(Array.isArray(i)?t.push(...i):t.push(i))}return t.length===0?null:t}return n==null||typeof n=="boolean"?null:typeof n=="string"||typeof n=="number"?F(String(n)):typeof n=="object"&&"__type__"in n?it(n,e):null}function it(n,e){switch(n.__type__){case u.Element:return st(n,e);case u.Fragment:return ot(n,e);case u.FunctionComponent:return ct(n,e);case u.ClassComponent:return at(n,e);case u.Primitive:return ut(n);default:return null}}function st(n,e){if(n.__type__!==u.Element)throw new Error("Expected ElementVNode");const t=n,{type:r,props:i,children:s}=t,o=J(r);if(i&&et(o,i),Array.isArray(s))for(const c of s){const a=p(c,e);a&&(Array.isArray(a)?a.forEach(l=>o.appendChild(l)):o.appendChild(a))}return U(t,o),o}function ot(n,e){if(n.__type__!==u.Fragment)throw new Error("Expected FragmentVNode");const t=n,{children:r}=t,i=[];if(Array.isArray(r))for(const s of r){const o=p(s,e);o&&(Array.isArray(o)?i.push(...o):i.push(o))}return H(t,i),i}function ct(n,e){if(n.__type__!==u.FunctionComponent)throw new Error("Expected FunctionComponentVNode");const t=n,{type:r,props:i,children:s}=t,o={...i,children:s.length===1?s[0]:s},a=r(o);if(!a)return E(t,void 0,null),null;const l=p(a,e);return E(t,a,l),l}function at(n,e){if(n.__type__!==u.ClassComponent)throw new Error("Expected ClassComponentVNode");const t=n,{type:r,props:i}=t,s=r,o=new s(i??{});$(t,o,e);const c=L(`fukict:${o.__name__}#${o.__id__}`);return t.__placeholder__=c,c}function ut(n){if(n.__type__!==u.Primitive)throw new Error("Expected PrimitiveVNode");const e=n,{value:t}=e;if(typeof t=="string"||typeof t=="number"){const r=F(String(t));return P(e,r),r}if(typeof t=="boolean"||t===null||t===void 0){const r=L(`fukict:primitive:${t===null?"null":t===void 0?"undefined":t}`);return P(e,r),r}return null}function g(n,e){if(n.__type__===u.FunctionComponent){const t=n.__rendered__;t&&typeof t=="object"&&"__type__"in t&&g(t);return}if(n.children&&Array.isArray(n.children)){for(const t of n.children)if(t&&typeof t=="object"&&"__type__"in t){const r=t;if(r.__type__===u.ClassComponent){const i=r.__instance__,s=r.__placeholder__;i&&s&&s.parentNode&&i.mount(s.parentNode,s)}else g(r)}}}function ft(n){const{vnode:e,container:t,placeholder:r,onMounted:i}=n,s=e.__instance__;s&&(r&&r.parentNode?(i?.(),s.mount(r.parentNode,r)):t&&(i?.(),s.mount(t)))}function lt(n){const{vnode:e,container:t,placeholder:r,onMounted:i}=n,s=e.__dom__,o=t||r?.parentNode;o&&(s&&(r&&r.parentNode?r.parentNode.replaceChild(s,r):o.appendChild(s)),i?.(),g(e))}function ht(n){const{vnode:e,container:t,placeholder:r,onMounted:i}=n,s=e.__dom__,o=t||r?.parentNode;o&&(Array.isArray(s)&&(r&&r.parentNode?(s.forEach(c=>{r.parentNode.insertBefore(c,r)}),r.parentNode.removeChild(r)):s.forEach(c=>o.appendChild(c))),i?.(),g(e))}function _t(n){const{vnode:e,container:t,placeholder:r,onMounted:i}=n,s=e.__dom__,o=t||r?.parentNode;if(!o)return;s&&(r&&r.parentNode?Array.isArray(s)?(s.forEach(a=>{r.parentNode.insertBefore(a,r)}),r.parentNode.removeChild(r)):r.parentNode.replaceChild(s,r):Array.isArray(s)?s.forEach(a=>o.appendChild(a)):o.appendChild(s)),i?.();const c=e.__rendered__;c&&typeof c=="object"&&"__type__"in c&&g(c)}function pt(n){const{vnode:e,container:t,placeholder:r,onMounted:i}=n,s=e.__dom__,o=t||r?.parentNode;o&&(s?r&&r.parentNode?r.parentNode.replaceChild(s,r):o.appendChild(s):r&&r.parentNode&&r.parentNode.removeChild(r),i?.())}function b(n){const{vnode:e,onMounted:t}=n,r="container"in n?n.container:void 0,i="placeholder"in n?n.placeholder:void 0;if(!e||typeof e!="object"||!("__type__"in e))return;const s=e;switch(s.__type__){case u.ClassComponent:ft({vnode:s,container:r,placeholder:i,onMounted:t});break;case u.Element:lt({vnode:s,container:r,placeholder:i,onMounted:t});break;case u.Fragment:ht({vnode:s,container:r,placeholder:i,onMounted:t});break;case u.FunctionComponent:_t({vnode:s,container:r,placeholder:i,onMounted:t});break;case u.Primitive:pt({vnode:s,container:r,placeholder:i,onMounted:t});break}}function dt(n){if(!n||typeof n=="string"||typeof n=="number"||typeof n=="boolean")return null;if(typeof n=="object"&&"__type__"in n){const e=n;if(e.__type__===u.ClassComponent){const r=e,s=r.__instance__?.__vnode__;if(s&&"__dom__"in s){const c=s.__dom__;if(c)return Array.isArray(c)?c[0]:c}const o=r.__placeholder__;return o?.parentNode?o:null}const t=e.__dom__;if(t)return Array.isArray(t)?t[0]:t}return null}function m(n,e,t){if(!n)throw new Error("Old VNode is required for replaceNode");const i=dt(n)?.nextSibling??null;if(C(n,t),!p(e))return;const o=document.createComment("fukict-replace");i&&i.parentNode===t?t.insertBefore(o,i):t.appendChild(o),b({vnode:e,placeholder:o})}function y(n){if(n&&!(typeof n=="string"||typeof n=="number"||typeof n=="boolean")){if(Array.isArray(n)){n.forEach(e=>y(e));return}if(typeof n=="object"&&"__type__"in n){const e=n;if(e.__type__===u.ClassComponent){const r=e.__instance__;r?.unmount&&r.unmount();return}if(e.__type__===u.FunctionComponent){const r=e.__rendered__;r&&y(r);return}if(e.__type__===u.Fragment){const t=e;t.children&&Array.isArray(t.children)&&t.children.forEach(r=>y(r));return}if(e.__type__===u.Element){const t=e;t.children&&Array.isArray(t.children)&&t.children.forEach(r=>y(r));return}if(e.__type__===u.Primitive)return}}}function C(n,e){if(n){if(y(n),typeof n=="string"||typeof n=="number"||typeof n=="boolean"){const t=String(n);Array.from(e.childNodes).filter(i=>i.nodeType===Node.TEXT_NODE&&i.textContent===t).forEach(i=>e.removeChild(i));return}if(typeof n=="object"&&"__type__"in n){const t=n;if(t.__type__===u.ClassComponent){const s=t.__placeholder__;s?.parentNode&&s.parentNode.removeChild(s);return}if(t.__type__===u.Primitive){const s=t.__dom__;s?.parentNode&&s.parentNode.removeChild(s);return}const r=t.__dom__;r&&(Array.isArray(r)?r.forEach(i=>{i.parentNode&&i.parentNode.removeChild(i)}):r.parentNode&&r.parentNode.removeChild(r))}}}function mt(n,e){if(n===e)return!0;if(!n||!e)return!1;const t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(const i of t)if(n[i]!==e[i])return!1;return!0}function v(n,e,t){const r=n.length,i=e.length,s=Math.min(r,i);for(let o=0;o<s;o++){const c=n[o],a=e[o];if((typeof c=="string"||typeof c=="number")&&(typeof a=="string"||typeof a=="number")){if(c!==a){const l=Array.from(t.childNodes);l[o]&&l[o].nodeType===Node.TEXT_NODE&&(l[o].textContent=String(a))}}else S(c,a,t)}if(r>i)for(let o=s;o<r;o++)C(n[o],t);if(i>r)for(let o=s;o<i;o++){const c=p(e[o]);c&&(Array.isArray(c)?c.forEach(a=>t.appendChild(a)):t.appendChild(c),b({vnode:e[o],container:t}))}}function yt(n,e,t,r){if(n.__type__!==u.ClassComponent||e.__type__!==u.ClassComponent)throw new Error("Expected ClassComponentVNode");const i=n,s=e;if(i.type!==s.type){m(i,s,t);return}const o=i.__instance__;if(o){if($(s,o,r),s.__placeholder__=i.__placeholder__,s.props&&s.props["fukict:detach"]){o.props=s.props;return}typeof o.update=="function"&&o.update(s.props??{})}}function gt(n,e,t){const r=e||{},i=t||{};for(const s of Object.keys(r))s in i||Ct(n,s,r[s]);for(const s of Object.keys(i)){const o=r[s],c=i[s];o!==c&&bt(n,s,c,o)}}function bt(n,e,t,r){if(e==="ref"&&typeof t=="function"){t(n);return}if(e==="fukict:html"){_(n,"innerHTML",t??"");return}if(e.startsWith("on:")){const i=e.slice(3);r&&typeof r=="function"&&q(n,i,r),t&&typeof t=="function"&&T(n,i,t);return}if(e==="style"&&typeof t=="object"&&t!==null){const i=typeof r=="object"&&r!==null?r:{},s=t;for(const o of Object.keys(i))o in s||N(n,o,"");for(const[o,c]of Object.entries(s))N(n,o,c);return}if(e==="value"||e==="checked"||e==="selected"){_(n,e,t);return}if(e==="class"){M(n,t);return}if(e in n&&!A(n.tagName.toLowerCase())){_(n,e,t);return}W(n,e,t)}function Ct(n,e,t){if(e==="fukict:html"){_(n,"innerHTML","");return}if(e.startsWith("on:")){const r=e.slice(3);typeof t=="function"&&q(n,r,t);return}if(e==="value"||e==="checked"||e==="selected"){_(n,e,"");return}if(e in n&&!A(n.tagName.toLowerCase())){_(n,e,void 0);return}Z(n,e)}function wt(n,e,t){if(n.__type__!==u.Element||e.__type__!==u.Element)throw new Error("Expected ElementVNode");const r=n,i=e;if(r.type!==i.type){m(r,i,t);return}const s=r.__dom__;if(!s){m(r,i,t);return}U(i,s),gt(s,r.props,i.props),v(r.children,i.children,s)}function Et(n,e,t){if(n.__type__!==u.Fragment||e.__type__!==u.Fragment)throw new Error("Expected FragmentVNode");const r=e;v(n.children,r.children,t);const i=[];for(const s of r.children)if(s&&typeof s=="object"&&"__dom__"in s){const o=s.__dom__;o&&(Array.isArray(o)?i.push(...o):i.push(o))}H(r,i)}function Pt(n,e,t){if(n.__type__!==u.FunctionComponent||e.__type__!==u.FunctionComponent)throw new Error("Expected FunctionComponentVNode");const r=n,i=e;if(r.type!==i.type){m(r,i,t);return}if(mt(r.props,i.props)){E(i,r.__rendered__,r.__dom__??null);return}const s={...i.props??{},children:i.children.length===1?i.children[0]:i.children},o=i.type,c=o(s),a=c&&typeof c=="object"&&"__type__"in c?c:void 0,l=r.__rendered__;S(l,c,t);let h=null;a&&a.__type__!==u.ClassComponent&&"__dom__"in a&&(h=a.__dom__??null),E(i,a,h)}function xt(n,e,t){if(n.__type__!==u.Primitive||e.__type__!==u.Primitive)throw new Error("Expected PrimitiveVNode");const r=n,i=e;if(r.value===i.value){i.__dom__=r.__dom__;return}const s=r.value,o=i.value,c=r.__dom__;if((typeof s=="string"||typeof s=="number")&&(typeof o=="string"||typeof o=="number")&&c&&c.nodeType===Node.TEXT_NODE){c.textContent=String(o),P(i,c);return}if((typeof s=="boolean"||s===null||s===void 0)&&(typeof o=="boolean"||o===null||o===void 0)&&c&&c.nodeType===Node.COMMENT_NODE){const a=c;a.textContent=`fukict:primitive:${o===null?"null":o===void 0?"undefined":o}`,P(i,a);return}m(r,i,t)}function S(n,e,t){if(Array.isArray(n)||Array.isArray(e)){const c=Array.isArray(n)?n:[n],a=Array.isArray(e)?e:[e];v(c,a,t);return}if(!n&&!e)return;if(n&&!e){C(n,t);return}if(!n&&e){const c=p(e);c&&(Array.isArray(c)?c.forEach(a=>t.appendChild(a)):t.appendChild(c),b({vnode:e,container:t}));return}if((typeof n=="string"||typeof n=="number"||typeof n=="boolean")&&(typeof e=="string"||typeof e=="number"||typeof e=="boolean")){if(n!==e){const c=String(n),a=String(e),l=Array.from(t.childNodes).filter(h=>h.nodeType===Node.TEXT_NODE&&h.textContent===c);l.length>0&&(l[0].textContent=a)}return}const r=typeof n=="object"&&n!==null&&"__type__"in n,i=typeof e=="object"&&e!==null&&"__type__"in e;if(!r||!i){m(n,e,t);return}const s=n,o=e;if(s.__type__!==o.__type__){m(s,o,t);return}switch(o.__type__){case u.Element:wt(s,o,t);break;case u.Fragment:Et(s,o,t);break;case u.FunctionComponent:Pt(s,o,t);break;case u.ClassComponent:yt(s,o,t);break;case u.Primitive:xt(s,o,t);break}}function D(n){return typeof n!="object"||n===null?n:new Proxy(n,{set(){return!1},deleteProperty(){return!1},get(e,t){const r=Reflect.get(e,t);return typeof r=="object"&&r!==null?D(r):r}})}function At(n){const t=n.__instance__;if(!t)return;const r=t.__wrapper__;if(!r||!r.props)return;const i=t.__parentInstance__;if(i&&i.__vnode__)return i.__vnode__.__context__}let Nt=0;class w{constructor(e){f(this,"__id__");f(this,"__name__");f(this,"props");f(this,"$slots");f(this,"$refs");f(this,"__vnode__");f(this,"__wrapper__");f(this,"__container__");f(this,"__placeholder__");f(this,"__inUpdating__");f(this,"__inMounting__");f(this,"__inUnmounting__");this.__id__=++Nt,this.__name__=this.constructor.name,this.props=e,this.$slots={},this.$refs={},this.__vnode__=null,this.__wrapper__=null,this.__container__=null,this.__placeholder__=null,this.__inUpdating__=!1,this.__inMounting__=!1,this.__inUnmounting__=!1}provideContext(e,t){this.__vnode__&&(this.__vnode__.__context__||(this.__vnode__.__context__={__parent__:At(this.__vnode__)}),this.__vnode__.__context__[e]=D(t))}getContext(e,t){if(this.__vnode__&&this.__vnode__.__context__){let r=this.__vnode__.__context__;for(;r;){if(e in r)return r[e];r=r.__parent__}}if(this.__wrapper__){const r=this.__wrapper__.__parentInstance__;if(r)return r.getContext(e,t)}return t}update(e){if(this.__inUpdating__||this.__inMounting__||this.__inUnmounting__)return;this.__inUpdating__=!0;const t=this.props;e!==void 0&&(this.props=e);const r=this.render(),i=r??R(r);this.__vnode__?.__context__&&(i.__context__=this.__vnode__.__context__),this.__vnode__&&this.__container__&&S(this.__vnode__,i,this.__container__),this.__vnode__=i,this.updated?.(t),this.__inUpdating__=!1}mount(e,t){if(this.__placeholder__=t||null,this.__container__=t?.parentElement||e,this.__inMounting__=!0,!this.__vnode__){const r=this.render();this.__vnode__=r??R(r)}p(this.__vnode__,this),b({vnode:this.__vnode__,...t?{placeholder:t}:{container:e},onMounted:()=>{this.__inMounting__=!1,this.mounted?.()}})}unmount(){this.__inUnmounting__=!0,this.beforeUnmount?.(),C(this.__vnode__,this.__container__);for(const e in this.$refs)delete this.$refs[e];this.__vnode__=null,this.__container__=null,this.__inUnmounting__=!1}}function R(n){return{__type__:u.Primitive,type:"primitive",value:n,props:null,children:[]}}function Rt(n){return typeof n=="string"||typeof n=="number"||typeof n=="boolean"||n===null||n===void 0}function vt(n){return n&&typeof n=="object"&&"__type__"in n?n:Rt(n)?R(n):(Array.isArray(n),null)}function z(n){const e=[];for(const t of n)if(Array.isArray(t))e.push(...z(t));else{const r=vt(t);r!==null&&e.push(r)}return e}function St(n){return n===Q?u.Fragment:typeof n=="string"?u.Element:typeof n=="function"?n.prototype&&n.prototype instanceof w?u.ClassComponent:u.FunctionComponent:u.Element}function kt(n,e,t){const r=z(t),i={type:n,props:e||{},children:r};return"__type__"in i||(i.__type__=St(n)),i}const jt=kt;function Tt(n,e){if(n==null){for(;e.firstChild;)Y(e,e.firstChild);return null}return p(n),b({vnode:n,container:e}),()=>{C(n,e)}}class B{constructor(){f(this,"listeners",new Set);f(this,"isListening",!1)}back(){window.history.back()}forward(){window.history.forward()}listen(e){return this.listeners.add(e),this.isListening||this.startListening(),()=>{this.listeners.delete(e),this.listeners.size===0&&this.stopListening()}}notifyListeners(){const e=this.getCurrentPath();for(const t of this.listeners)t(e)}}class Ft extends B{constructor(t="/"){super();f(this,"base");f(this,"handlePopState",()=>{this.notifyListeners()});this.base=this.normalizeBase(t)}normalizeBase(t){return t.startsWith("/")||(t="/"+t),t.length>1&&t.endsWith("/")&&(t=t.slice(0,-1)),t}getCurrentPath(){let t=window.location.pathname;return this.base!=="/"&&t.startsWith(this.base)&&(t=t.slice(this.base.length)),t.startsWith("/")||(t="/"+t),window.location.search&&(t+=window.location.search),window.location.hash&&(t+=window.location.hash),t}push(t){const r=this.getFullPath(t);window.history.pushState(null,"",r),this.notifyListeners()}replace(t){const r=this.getFullPath(t);window.history.replaceState(null,"",r),this.notifyListeners()}startListening(){window.addEventListener("popstate",this.handlePopState),this.isListening=!0}stopListening(){window.removeEventListener("popstate",this.handlePopState),this.isListening=!1}getFullPath(t){return t.startsWith("/")||(t="/"+t),this.base!=="/"&&(t=this.base+t),t}}class Lt extends B{constructor(){super();f(this,"handleHashChange",()=>{this.notifyListeners()});window.location.hash||(window.location.hash="#/")}getCurrentPath(){return window.location.hash.slice(1)||"/"}push(t){t.startsWith("/")||(t="/"+t),window.location.hash=t,this.notifyListeners()}replace(t){t.startsWith("/")||(t="/"+t);const r=new URL(window.location.href);r.hash=t,window.history.replaceState(null,"",r.toString()),this.notifyListeners()}startListening(){window.addEventListener("hashchange",this.handleHashChange),this.isListening=!0}stopListening(){window.removeEventListener("hashchange",this.handleHashChange),this.isListening=!1}}function I(n="hash",e){return n==="history"?new Ft(e):new Lt}class k{constructor(e,t=""){f(this,"compiledRoutes",[]);f(this,"routes");this.routes=e,this.compile(e,t)}compile(e,t){for(const r of e){const i=this.resolvePath(t,r.path),s=this.compileRoute(r,i);if(this.compiledRoutes.push(s),r.children&&r.children.length>0){const o=new k(r.children,i);this.compiledRoutes.push(...o.compiledRoutes)}}t===""&&this.sortByPriority()}resolvePath(e,t){if(t==="")return this.normalizePath(e||"/");if(t.startsWith("/"))return this.normalizePath(e+t);const r=e.endsWith("/")?"":"/";return this.normalizePath(e+r+t)}sortByPriority(){this.compiledRoutes.sort((e,t)=>t.priority-e.priority)}calculatePriority(e,t){if(e.some(s=>s.isWildcard))return-1e3;let i=0;i+=1e3;for(const s of e)s.isDynamic?i+=10:i+=50;return t.children&&t.children.length>0&&(i-=1),i}compileRoute(e,t){const r=[],i=[],s=t.split("/").filter(a=>a!=="");for(const a of s)if(a==="*")r.push({isDynamic:!1,isWildcard:!0});else if(a.startsWith(":")){const l=a.slice(1);r.push({isDynamic:!0,paramName:l,isWildcard:!1}),i.push(l)}else r.push({isDynamic:!1,value:a,isWildcard:!1});const o=this.buildRegex(r),c=this.calculatePriority(r,e);return{config:e,segments:r,regex:o,paramNames:i,fullPath:t,priority:c}}buildRegex(e){if(e.length===0)return/^\/$/;let t="^";for(const i of e)t+="\\/",i.isWildcard?t+=".*":i.isDynamic?t+="([^/]+)":t+=this.escapeRegex(i.value);return e[e.length-1]?.isWildcard||(t+="\\/?$"),new RegExp(t)}escapeRegex(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}normalizePath(e){return e.startsWith("/")||(e="/"+e),e.length>1&&e.endsWith("/")&&(e=e.slice(0,-1)),e=e.replace(/\/+/g,"/"),e}match(e){e=this.normalizePath(e);for(const t of this.compiledRoutes){const r=t.regex.exec(e);if(r){const i={};for(let o=0;o<t.paramNames.length;o++){const c=t.paramNames[o],a=r[o+1];i[c]=decodeURIComponent(a)}return this.buildMatchChain(t.config,e,i)}}return null}buildMatchChain(e,t,r){const i=[],s=(c,a)=>{for(const l of a){if(l===c)return[l];if(l.children&&l.children.length>0){const h=s(c,l.children);if(h)return[l,...h]}}return null},o=s(e,this.routes);if(o)for(const c of o)i.push({config:c,params:r,path:t});else i.push({config:e,params:r,path:t});return i}findByName(e){for(const t of this.compiledRoutes)if(t.config.name===e)return t.config;return null}buildPath(e,t={}){let r=e.path;for(const[i,s]of Object.entries(t))r=r.replace(`:${i}`,encodeURIComponent(s));return this.normalizePath(r)}}const d=class d{constructor(e,t=0){f(this,"history");f(this,"matcher");f(this,"currentRoute");f(this,"listeners",new Set);f(this,"beforeEachGuards",[]);f(this,"afterEachHooks",[]);f(this,"depth");f(this,"options");this.options=e,this.depth=t,this.history=e.history||I(e.mode||"hash",e.base),this.matcher=new k(e.routes);const r=this.history.getCurrentPath(),i=this.createRoute(r);if(i.meta.__redirect__){const s=i.meta.__redirect__;this.history.replace(s),this.currentRoute=this.createRoute(s)}else this.currentRoute=i;e.beforeEach&&this.beforeEachGuards.push(e.beforeEach),e.afterEach&&this.afterEachHooks.push(e.afterEach),t===0&&(d.instance=this)}static getInstance(){return d.instance}get matched(){return this.currentRoute.matched[this.depth]||null}createChild(){const e=new d(this.options,this.depth+1);return e.currentRoute=this.currentRoute,e}destroy(){this.listeners.clear(),d.instance===this&&(d.instance=null)}async navigate(e){const t=this.createRoute(e),r=this.currentRoute;if(t.meta.__redirect__){const o=t.meta.__redirect__;this.history.replace(o);return}let i=!0,s=null;for(const o of this.beforeEachGuards)if(await new Promise(c=>{o(t,r,a=>{a===!1?i=!1:typeof a=="string"&&(i=!1,s=a),c()})}),!i)break;if(i&&t.matched.length>0){const o=t.matched[t.matched.length-1];o.beforeEnter&&await new Promise(c=>{o.beforeEnter(t,r,a=>{a===!1?i=!1:typeof a=="string"&&(i=!1,s=a),c()})})}if(s){this.push(s);return}if(!i){this.history.replace(r.path);return}this.currentRoute=t,this.notify();for(const o of this.afterEachHooks)o(t,r)}async updateRoute(e){const t=this.createRoute(e),r=this.currentRoute;if(t.meta.__redirect__){const o=t.meta.__redirect__;this.replace(o);return}let i=!0,s=null;for(const o of this.beforeEachGuards)if(await new Promise(c=>{o(t,r,a=>{a===!1?i=!1:typeof a=="string"&&(i=!1,s=a),c()})}),!i)break;if(i&&t.matched.length>0){const o=t.matched[t.matched.length-1];o.beforeEnter&&await new Promise(c=>{o.beforeEnter(t,r,a=>{a===!1?i=!1:typeof a=="string"&&(i=!1,s=a),c()})})}if(s){this.replace(s);return}if(!i){this.history.replace(r.path);return}this.currentRoute=t,this.notify();for(const o of this.afterEachHooks)o(t,r)}createRoute(e){const{path:t,query:r,hash:i}=this.parseLocation(e),s=this.matcher.match(t);if(s&&s.length>0){const o=s[s.length-1];if(o.config.redirect)return{path:t,query:r,hash:i,params:o.params,meta:{...o.config.meta,__redirect__:o.config.redirect},matched:s.map(a=>a.config)};const c=s.map(a=>a.config);return{path:t,query:r,hash:i,params:o.params,meta:o.config.meta||{},matched:c}}return{path:t,query:r,hash:i,params:{},meta:{},matched:[]}}parseLocation(e){const t={};let r=e,i="";const s=r.indexOf("#");s!==-1&&(i=r.slice(s),r=r.slice(0,s));const o=r.indexOf("?");if(o!==-1){const c=r.slice(o+1);r=r.slice(0,o),new URLSearchParams(c).forEach((l,h)=>{t[h]=l})}return{path:r,query:t,hash:i}}buildPath(e){if(typeof e=="string")return e;let t=e.path||this.currentRoute.path;const r=e.query||this.currentRoute.query,i=this.stringifyQuery(r);i&&(t+="?"+i);const s=e.hash||this.currentRoute.hash;return s&&(t+=s),t}stringifyQuery(e){const t=new URLSearchParams;for(const[r,i]of Object.entries(e))t.append(r,i);return t.toString()}push(e){const t=this.buildPath(e);this.history.push(t)}replace(e){const t=this.buildPath(e);this.history.replace(t)}back(){this.history.back()}forward(){this.history.forward()}beforeEach(e){this.beforeEachGuards.push(e)}afterEach(e){this.afterEachHooks.push(e)}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}notify(){for(const e of this.listeners)e()}};f(d,"instance",null);let x=d;class qt extends w{get router(){return this.props.router}get matched(){return this.router.matched}get route(){return this.router.currentRoute}get params(){return this.route.params}get query(){return this.route.query}get meta(){return this.route.meta}push(e){this.router.push(e)}replace(e){this.router.replace(e)}back(){this.router.back()}forward(){this.router.forward()}updateQuery(e){this.push({path:this.route.path,query:{...this.route.query,...e},hash:this.route.hash})}updateParams(e){const t=this.matched;if(!t)return;let r=t.path;for(const[i,s]of Object.entries(e))typeof s=="string"&&(r=r.replace(`:${i}`,s));this.push({path:r,query:this.route.query,hash:this.route.hash})}update(e){const t=this.params,r=this.query;super.update(e);const i=this.params,s=this.query;this.routeParamsChanged&&!this.isParamsEqual(t,i)&&this.routeParamsChanged(i,t),this.routeQueryChanged&&!this.isQueryEqual(r,s)&&this.routeQueryChanged(s,r)}isParamsEqual(e,t){const r=e,i=t,s=Object.keys(r),o=Object.keys(i);if(s.length!==o.length)return!1;for(const c of s)if(r[c]!==i[c])return!1;return!0}isQueryEqual(e,t){const r=e,i=t,s=Object.keys(r),o=Object.keys(i);if(s.length!==o.length)return!1;for(const c of s)if(r[c]!==i[c])return!1;return!0}}class Ot extends w{constructor(){super(...arguments);f(this,"childRouter",null)}beforeUnmount(){this.childRouter=null}getRouterForChild(t){return t.children&&t.children.length>0?(this.childRouter||(this.childRouter=this.props.router.createChild()),this.childRouter.currentRoute=this.props.router.currentRoute,this.childRouter):this.props.router}render(){const t=this.props.router.matched;if(!t||!t.component)return this.props.fallback||{type:"div",__type__:u.Element,props:{class:"router-view"},children:[]};const r=t.component,i=this.getRouterForChild(t);return{type:r,__type__:u.ClassComponent,props:{router:i},children:[]}}}class $t extends w{constructor(t){super(t);f(this,"router",null);f(this,"history",null);f(this,"unlisten",null);this.history=I(this.props.mode||"hash",this.props.base),this.router=new x({routes:this.props.routes,mode:this.props.mode||"hash",base:this.props.base,beforeEach:this.props.beforeEach,afterEach:this.props.afterEach,history:this.history})}mounted(){this.history&&(this.unlisten=this.history.listen(t=>{this.router&&this.router.updateRoute(t).then(()=>{this.update()})}))}beforeUnmount(){this.unlisten&&(this.unlisten(),this.unlisten=null),this.router&&(this.router.destroy(),this.router=null),this.history=null}render(){return this.router?{type:Ot,__type__:u.ClassComponent,props:{router:this.router,fallback:this.props.fallback},children:[]}:{type:"element",__type__:u.Element,props:{class:"router-provider"},children:[]}}}class Ut extends w{constructor(){super(...arguments);f(this,"handleClick",t=>{t.preventDefault();const r=this.getRouter();if(!r)return;const{to:i,replace:s}=this.props;s?r.replace(i):r.push(i)})}getRouter(){return x.getInstance()}buildPath(){const{to:t}=this.props;if(typeof t=="string")return t;const r=this.getRouter();if(!r)return"/";let i=t.path||r.currentRoute.path;if(t.query){const s=new URLSearchParams;for(const[c,a]of Object.entries(t.query))s.append(c,a);const o=s.toString();o&&(i+="?"+o)}return t.hash&&(i+=t.hash),i}buildHref(){const t=this.buildPath(),r=this.getRouter();if(!r)return t;const i=r.history;return i&&i.constructor.name==="HashHistory"?`#${t}`:t}isActive(){const t=this.getRouter();if(!t)return!1;const r=this.buildPath();return t.currentRoute.path.startsWith(r)}isExactActive(){const t=this.getRouter();if(!t)return!1;const r=this.buildPath();return t.currentRoute.path===r}render(){const{activeClass:t="router-link-active",exactActiveClass:r="router-link-exact-active"}=this.props,i=this.buildHref(),s=this.isActive(),o=this.isExactActive(),c=["router-link"];return this.props.class&&c.push(this.props.class),s&&c.push(t),o&&c.push(r),jt("a",{href:i,class:c.join(" "),"on:click":this.handleClick},Array.isArray(this.$slots.default)?this.$slots.default:this.$slots.default?[this.$slots.default]:[])}}class Mt{constructor(e){f(this,"internalState");f(this,"stateProxy");f(this,"subscriptions",new Set);this.internalState=e,this.stateProxy=this.createReadonlyProxy(e)}createReadonlyProxy(e){return new Proxy(e,{get(t,r,i){const s=Reflect.get(t,r,i);return s!==null&&typeof s=="object"?new Proxy(s,{get:(o,c,a)=>Reflect.get(o,c,a),set:()=>!1,deleteProperty:()=>!1}):s},set:()=>!1,deleteProperty:()=>!1})}getState(){return this.stateProxy}setState(e){this.isPartialUpdate(e)?this.internalState={...this.internalState,...e}:this.internalState=e,this.stateProxy=this.createReadonlyProxy(this.internalState),this.notify()}subscribe(e,t){let r;if(t){const i=e,s=i(this.internalState);r={listener:t,selector:i,lastValue:s}}else r={listener:e};return this.subscriptions.add(r),()=>{this.subscriptions.delete(r)}}notify(){for(const e of this.subscriptions)if(e.selector){const t=e.selector(this.internalState);this.shallowEqual(e.lastValue,t)||(e.lastValue=t,e.listener(t))}else e.listener(this.stateProxy)}isPartialUpdate(e){const t=Object.keys(e),r=Object.keys(this.internalState);return t.length<r.length}shallowEqual(e,t){if(Object.is(e,t))return!0;if(e==null||t==null)return!1;if(typeof e=="object"&&typeof t=="object"){const r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(const s of r)if(!Object.is(e[s],t[s]))return!1;return!0}return!1}}function Ht(n){const e=new Mt(n.state),t=()=>({getState:()=>e.getState(),setState:o=>e.setState(o)}),r={};if(n.actions)for(const o of Object.keys(n.actions)){const c=n.actions[o];r[o]=(...a)=>{const l=e.getState(),h=c(l,...a);h!=null&&e.setState(h)}}const i={};if(n.asyncActions)for(const o of Object.keys(n.asyncActions)){const c=n.asyncActions[o];i[o]=async(...a)=>{const l=t();await c(l,...a)}}return{get state(){return e.getState()},actions:r,asyncActions:i,subscribe:((o,c)=>c?e.subscribe(o,c):e.subscribe(o)),getState:()=>e.getState(),setState:o=>e.setState(o)}}export{w as F,Ut as L,qt as R,Q as a,Ot as b,Tt as c,Ht as d,$t as e,kt as h};
